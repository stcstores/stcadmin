{% extends "inventory/range_settings.html" %}
{% load staticfiles %}
{% load inventory_extras %}

{% block additional_head %}
{{ block.super }}
<script src="{% static 'scripts/stock_manager.js' %}"></script>
{% endblock %}

{% block page_title %}CCP Stock Manager{% endblock %}

{% block content %}{{ block.super }}
<form action="" method="POST">{% csrf_token %}
    {{ formset.management_form }}
    {% if formset.errors %}{{ formset.errors }}{% endif %}
    <table>
        <tr>
            <th>Product</th>
            <th>Stock Level</th>
            <th>Bays</th>
        </tr>
        {% for form in formset %}
        <tr hidden><td>{{ form.product_id }}</td></tr>
        <tr>
            <td class="title_field">{{ form.product_name.value }}</td>
            <td class="stock_level_field">{{ form.stock_level.value }}</td>
            <td class="location_field">{{ form.locations }}</td>
        </tr>
        {% endfor %}
    </table>
    <input type="submit" value="Update Locations" />
</form>
{% endblock %}

{% block script %}
<script>


function set_autocomplete() {
    var bays = [{% for bay in bays %}'{{ bay }}', {% endfor %}]
    $('.location_field input').autocomplete({source: bays});
}
$(document).click(function() {
    set_autocomplete();
});
$(document).keypress(function() {
    set_autocomplete();
});

</script>

{% endblock %}
