{% for supplier, products in suppliers.items %}
    <div class="result mt-5">
        <h4>{{ supplier.name }}</h4>
        <table class="table table-hover table-sm mt-3">
            <thead>
                <tr>
                    <th>SKU</th>
                    <th>Product</th>
                    <th>Supplier SKU</th>
                    <th>Barcode</th>
                    <th>Purchase Price</th>
                    <th>Re-Order</th>
                    <th>Stock Level</th>
                    <th>Additional Suppliers</th>
                </tr>
            </thead>
            <tbody>
                {% for product in products %}
                    <tr>
                        <td class="sku">{{ product.sku }}</td>
                        <td class="name">{{ product.full_name }}</td>
                        <td class="sku">{{ product.supplier_sku }}</td>
                        <td class="sku">{{ product.barcode }}</td>
                        <td>
                            <input type="text"
                                   value="{{ product.purchase_price }}"
                                   size="6"
                                   class="purchase_price_input"
                                   id="purchase_price_input_{{ product.id }}"
                                   data-product_id="{{ product.id }}"
                                   onclick="this.select()">
                            <span class="purchase_price_status"
                                  id="purchase_price_status_{{ product.id }}">
                                <i class="fa-solid fa-check"></i>
                            </span>
                        </td>
                        <td>
                            <input type="text"
                                   value="0"
                                   size="2"
                                   class="order_count_input"
                                   id="order_count_input_{{ product.id }}"
                                   data-product_id="{{ product.id }}"
                                   onclick="this.select()">
                            <button class="ordered_button"
                                    id="ordered_button_{{ product.id }}"
                                    data-product_id="{{ product.id }}">Ordered</button>
                            <span class="order_count_status" id="order_count_status_{{ product.id }}">
                                <i class="fa-solid fa-check"></i>
                            </span>
                        </td>
                        <td>
                            {% if product_range.is_end_of_line or product.is_end_of_line %}
                                <span class="error">Stock levels are not available for EOL products</span>
                            {% else %}
                                {% include "inventory/update_stock.html" %}
                            {% endif %}
                        </td>
                        <td>
                            <textarea name="comment"
                                      id="comment_{{ product.id }}"
                                      class="comment_input"
                                      cols="30"
                                      rows="1"
                                      data-product_id="{{ product.id }}"></textarea>
                            <span class="comment_status" id="comment_status_{{ product.id }}">
                                <i class="fa-solid fa-check"></i>
                            </span>
                        </td>
                        <td>
                            {% for supplier in product.additional_suppliers.all %}
                                <span class="badge bg-secondary">{{ supplier }}</span>
                            {% endfor %}
                        </td>
                    </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>
{% endfor %}

{{ reorder_counts|json_script:"reorderCounts" }}
{{ comments|json_script:"reorderComments" }}
